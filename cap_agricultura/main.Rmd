---
documentclass: report
output:
  pdf_document:
    template: ../template/boletim.tex
    pandoc_args: "--lua-filter=../filter/crossref.lua"
---

```{r include=F, message=F, warning=F}
library(tidyverse)
library(scales)
library(zoo)
library(ipeadatar)
library(petgg)
library(kableExtra)
library(sidrar)
library(lubridate)
library(petknitr)
library(janitor)

petknitr::setup()
petgg::set_theme()

m <- 1000
M <- 1000000
B <- 1000000000

# converte AAAAMM para formato MT/AAAA
triForm <- function(x) paste0(substr(x, 6, 6),"T\n",substr(x, 1, 4))
```


# Agronegócio


O agronegócio consolidou-se como o principal motor de crescimento do PIB do Tocantins, desempenhando papel estratégico na economia estadual e nacional. Em 2023, segundo o Instituto Brasileiro de Geografia e Estatística (IBGE), a agropecuária tocantinense registrou o avanço expressivo de 25,6%, impulsionando o PIB estadual a crescer 11,4% no período, resultado que colocou o estado entre os de maior expansão no Brasil, ao lado de Mato Grosso e Mato Grosso do Sul. Além do desempenho econômico, o Tocantins firmou-se como grande produtor de grãos, com destaque para a soja, carro-chefe da produção, como é visível na [fig:@producao]. 

A produção agrícola do Tocantins atingiu 10,6 milhões de toneladas em 2023, consolidando o estado como o maior produtor de grãos da Região Norte e registrando crescimento de 17,9% em relação ao ano anterior. A soja manteve-se como cultura predominante, representando 40,7% do total, seguida pela cana-de-açúcar, com 28,8%, e pelo milho, com 22,5%. Arroz e mandioca, apesar de menores em volume, conforme a [fig:@area_plantada], continuaram relevantes para consumo interno. Os resultados apontam para um cenário de diversificação agrícola no estado, embora a produção de grãos, sobretudo a soja, ainda permaneça como eixo primordial. 

Segundo a [fig:@rendim_medio], a cana lidera o rendimento médio das lavouras, com quase 74% da produtividade, reforçada pela presença da maior usina de processamento da Região Norte, a Bunge Pedro Afonso, instalada no Tocantins. A seguir, a mandioca, com 14,1%, cuja cadeia produtiva tem sido fortalecida por políticas do governo em parceria com a Embrapa, o que resultou em aumento de 1,88% no rendimento frente ao ano anterior. A soja, embora seja o produto de maior volume, respondeu apenas por 2,9% no indicador, revelando a diferença entre área plantada e produtividade final. Enquanto o arroz e milho juntos não somaram 10%. 

Segundo a Pesquisa Agrícola Municipal (PAM) de 2023, a área plantada no estado manteve a soja como a cultura predominante, ocupando 1,33 milhão de hectares, o que corresponde a 65,9% da área total, apresentando uma leve redução em relação aos 66,8% registrados em 2022. Em contrapartida, o milho registrou um crescimento notável, subindo de 24,1% para 26,1%, o que demonstra a expansão da cultura no estado. O arroz viu sua porcentagem diminuir de 6,3% para 5,3%, enquanto a cana-de-açúcar se manteve estável em aproximadamente 1,8%. Já a mandioca apresentou uma queda, passando de 0,95% para 0,76%.

```{r producao, fig.cap= "Produção Tocantins", fig.subcap="Em milhões de toneladas. Estimativa anual", fig.source = "\\acrshort{ibge}, 2023.", wrap = "open"}
# Produção - Tocantins 2022

# Os produtos são Arroz, milho 1 safra, milho 2 safra, soja, cana de açucar e mandioca
produtos <- c(39432, 39441, 39442, 39443, 39456, 39467)

# Série histórica da estimativa anual da área plantada, área colhida, produção e rendimento médio dos produtos das lavouras
prod <- get_sidra(
  x = 6588,
  variable = 35,
  period =  "202412",
  header = TRUE,
  geo = "State",
  geo.filter = list("State" = 17),
  format = 4
)

prod <- prod %>%
  clean_names()

prod %>%
  filter(
    `mes_codigo` == "202412",
    `produto_das_lavouras_codigo` %in% produtos
  ) %>%
  transmute(
    produto = `produto_das_lavouras`,
    valor = valor
  ) %>%
  mutate(
    produto = str_extract(produto, ".[a-z]+")
  ) %>%
  group_by(produto) %>%
  summarise(total = sum(valor)) %>%
  ggplot() +
  geom_bar(aes(x = produto, y = total), stat = "identity") +
  scale_y_continuous(labels = function(n) n / M)
```

```{r rendim_medio, fig.cap= "Rendimento médio das lavouras", fig.subcap="Mil quilogramas por hectare. Estimativa anual", fig.source = "\\acrshort{sidra}/IBGE, 2023."}
rend_medio <- get_sidra(
  x = 6588,
  variable = 36,
  period = "202312",
  geo = "State",
  geo.filter = list("State" = 17),
  header = TRUE,
  format = 4
)

rend_medio <- rend_medio %>%
  clean_names()

rend_medio %>%
  filter(`produto_das_lavouras_codigo` %in% produtos) %>%
  transmute(
    produto = `produto_das_lavouras`,
    valor = valor
  ) %>%
  mutate(
    produto = str_extract(produto, ".[a-z]+")
  ) %>%
  group_by(produto) %>%
  summarise(total = sum(valor)) %>%
  ggplot() +
  geom_bar(aes(x = produto, y = total), stat = "identity") +
  scale_y_continuous(labels = function(n) n / m)
```
    
```{r area_plantada, fig.cap= "Área plantada das lavouras", fig.subcap="Em mil hectares. Estimativa anual", fig.source = "\\acrshort{sidra}/IBGE, 2023.", wrap = "close"}
# Área Plantada
area_plan <- get_sidra(
  x = 6588,
  variable = 216,
  period = "202312",
  geo = "State",
  geo.filter = list("State" = 17),
  header = TRUE,
  format = 4
)

area_plan <- area_plan %>%
  clean_names()

area_plan %>%
  filter(`produto_das_lavouras_codigo` %in% produtos) %>%
  transmute(
    produto = `produto_das_lavouras`,
    valor = valor
  ) %>%
  mutate(
    produto = str_extract(produto, ".[a-z]+")
  ) %>%
  group_by(produto) %>%
  summarise(total = sum(valor)) %>%
  ggplot() +
  geom_bar(aes(x = produto, y = total), stat = "identity") +
  scale_y_continuous(labels = function(n) n / m)
```
Com base na Pesquisa Pecuária Municipal (PPM) de 2023, o rebanho bovino do estado alcançou 11,3 milhões de cabeças, representando 58,7% do efetivo total. Em contrapartida, os galináceos somaram 7,9 milhões de cabeças, 41,2% do total. Comparado a 2020, o rebanho bovino teve um crescimento de cerca de 2,2 milhões de animais, enquanto o de galináceos registrou significativa redução. Entre os anos de 2022 e 2023, o estado foi um dos principais impulsionadores do abate nacional de bovinos e se tornou o oitavo maior exportador de carne bovina do país em 2023, correspondendo em 4,4% das exportações. 
```{r efetivos, fig.cap= "Efetivo de Rebanhos dos principais animais",   fig.subcap = "Cabeças", fig.source =         "\\acrshort{sidra}/IBGE, 2025.", wrap = TRUE}
# Seleção de Anos
anos <- 2020:2030

# Rebanho de Bovinos
efetivo_bovino <- get_sidra(
  x = 3939,
  variable = 105,
  geo = "State",
  geo.filter = list("State" = 17),
  period = as.character(anos),
  ) %>% filter(
  `Tipo de rebanho` == "Bovino"
  ) %>%
  select(Ano, Valor)

# Rebanho de Galináceos
efetivo_galinaceos <- get_sidra(
  x = 3939,
  variable = 105,
  geo = "State",
  geo.filter = list("State" = 17),
  period = as.character(anos),
  ) %>% filter(
  `Tipo de rebanho` == "Galináceos - total"
  ) %>%
  select(Ano, Valor)

total <- left_join(efetivo_bovino, efetivo_galinaceos, by = "Ano")

bind_rows(
  efetivo_bovino %>% mutate(tipo = "Bovinos"),
  efetivo_galinaceos %>% mutate(tipo = "Galináceos")
) %>%
  select(Ano, tipo, Valor) %>%  # Seleciona apenas Ano (não precisa de trimestre)
  drop_na() %>%
  ggplot(aes(
    x = factor(Ano, levels = c("2020","2021", "2022", "2023")),  # Ordena os anos
    y = Valor,
    fill = tipo
  )) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = function(n) n / 1e3) 

```
O abate de bois mostrou um crescimento notável passando de 146.239 no primeiro trimestre para um pico de 219.765 no terceiro trimestre. A quantidade de abate de vacas teve o movimento oposto, começando o ano com 146.239 cabeças e caindo para 89.390 no terceiro trimestre. Já o abate de frangos manteve volumes elevados, superando 5 milhões de cabeças nos trimestres com dados disponíveis. No quarto trimestre, o abate de frangos atingiu o seu pico, com 5.459.641 aves abatidas. O estado tem realizado ações para fomentar a avicultura, como a regularização de terras e atração de novos investimentos. 
```{r abates, fig.cap= "Abate dos principais animais",   fig.subcap = "Mil cabeças", fig.source =         "\\acrshort{sidra}/IBGE, 2025.", wrap = TRUE}
# Abate de frangos, bovinos, vacas por trimestre
# Unidade em Cabeças
abate_bovino <- get_sidra(
  x = 1092,
  period = c("202301", "202302", "202303", "202304"),
  geo = "State",
  geo.filter = list("State" = 17),
  header = TRUE,
  format = 4
  ) %>% filter(
  `Tipo de rebanho bovino` %in% c(
    "Novilhos",
    "Novilhas",
    "Bois",
    "Vacas"
  ),
  `Referência temporal` == "Total do trimestre",
  `Tipo de inspeção` == "Total",
  `Variável` == "Animais abatidos"
  ) %>%
  select(`Trimestre (Código)`, `Tipo de rebanho bovino`, Valor)

# Unidade em cabeças
abate_frango <- get_sidra(
  x = 1094,
  period = c("202301", "202302", "202303", "202304"),
  geo = "State",
  geo.filter = list("State" = 17),
  header = TRUE,
  format = 4
) %>%
  filter(
  `Referência temporal` == "Total do trimestre",
  `Tipo de inspeção` == "Total",
  `Variável` == "Animais abatidos"
  ) %>%
  select(`Trimestre (Código)`, Valor)

bind_rows(
  abate_bovino %>% mutate(tipo = `Tipo de rebanho bovino`),
  abate_frango %>% mutate(tipo = "Frango")
) %>%
  select(`Trimestre (Código)`, tipo, Valor) %>%
  drop_na() %>%
  mutate(tri = triForm(`Trimestre (Código)`)) %>%
  ggplot(aes(factor(tri, levels = c("1T\n2023", "2T\n2023", "3T\n2023", "4T\n2023")), Valor, fill = tipo)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = function(n) n / m)
```
A produção animal no estado se destaca pela diversificação, a produção de leite no ano de 2023 foi superior a 417 milhões de litros, apesar de uma queda, em relação a 2021. Já produção de mel atingiu 108 mil quilos, superando 2022, enquanto a de ovos chegou a 53 mil dúzias, o melhor desempenho histórico. Há investimentos em tecnologia e melhoramento genético por parte do governo do estado, além de regulamentação para garantir a sanidade animal por meio de mecanismos como o Sistema de Inspeção Estadual (SIE) e o Selo de Garantia, que promovem a expansão das agroindústrias e a geração de renda.

Em síntese, o panorama do agronegócio tocantinense em 2023 revela um setor robusto e em plena expansão, principalmente ao observar as séries históricas, alicerçado em uma dupla vocação para a produção de grãos e a pecuária de corte. Os dados demonstram não apenas a liderança consolidada da soja em área plantada, mas também a eficiência produtiva em culturas como a cana-de-açúcar. O arroz também deve ser mencionado, uma vez que o Tocantins é o terceiro Estado do Brasil em maior área plantada e quantidade produzida. Na pecuária, o crescimento do rebanho bovino e os expressivos números de abate reforçam a posição do estado como um polo exportador.    
```{r produtos_origem, fig.cap= "Produção de Origem Animal",   fig.subcap = "Unidades", fig.source =         "\\acrshort{sidra}/IBGE, 2025.", wrap = TRUE}
# Seleção de Anos
anos <- 2020:2030

# Produção de ovo
ovos_galinha <- get_sidra(
  x = 74,
  variable = 106,
  geo = "State",
  geo.filter = list("State" = 17),
  period = as.character(anos),
  ) %>% filter(
  `Tipo de produto de origem animal` == "Ovos de galinha"
  ) %>%
  select(Ano, Valor)

# RProdução de Leite
leite <- get_sidra(
  x = 74,
  variable = 106,
  geo = "State",
  geo.filter = list("State" = 17),
  period = as.character(anos),
  ) %>% filter(
  `Tipo de produto de origem animal` == "Leite"
  ) %>%
  select(Ano, Valor)

# Produção de mel
mel_abelha <- get_sidra(
  x = 74,
  variable = 106,
  geo = "State",
  geo.filter = list("State" = 17),
  period = as.character(anos),
  ) %>% filter(
  `Tipo de produto de origem animal` == "Mel de abelha"
  ) %>%
  select(Ano, Valor)

total <- left_join(ovos_galinha, leite, mel_abelha, by = "Ano")

bind_rows(
  ovos_galinha %>% mutate(tipo = "Ovos de Galinha (mil dúzias)"),
  leite %>% mutate(tipo = "Leite (mil litros)"),
  mel_abelha %>% mutate(tipo = "Mel de Abelha (quilogramas)"),
) %>%
  select(Ano, tipo, Valor) %>%  # Seleciona apenas Ano (não precisa de trimestre)
  drop_na() %>%
  ggplot(aes(
    x = factor(Ano, levels = c("2020", "2021", "2022", "2023")),  # Ordena os anos
    y = Valor,
    fill = tipo
  )) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(labels = function(n) n / 1e3) 

```


